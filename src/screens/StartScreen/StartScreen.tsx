import React, { useEffect, useRef, useState } from 'react';
import { createPortal } from 'react-dom';
// import Scrollbar from 'smooth-scrollbar';

import Header from '@components/Header';
import Button from '@components/Button';
import Sidebar from '@components/Sidebar';
import BackCallModal from '@components/BackCallModal';

import styles from './StartScreen.module.scss';

export const StartScreen = (props: any) => {
  const [isSidebarVisible, setIsSidebarVisible] = useState(false);
  const [isBackCall, setIsBackCall] = useState(false);
  const ref = useRef<HTMLDivElement | null>(null);

  const handleScroll = () => {
    const position = window.scrollY;
    const winHeight = window.innerHeight;

    if (position > winHeight) {
      ref.current?.classList.add(styles.visible);
    } else {
      ref.current?.classList.remove(styles.visible);
    }
  };

  useEffect(() => {
    window.addEventListener('scroll', handleScroll, { passive: true });

    return () => {
      window.removeEventListener('scroll', handleScroll);
    };
  }, []);

  return (
    <>
      <section className={styles.screen}>
        <Header logoSmall={props.logoSmall} setIsSidebarVisible={setIsSidebarVisible} setIsBackCall={setIsBackCall} />
        <div className={styles.screen_bg}>{props.background}</div>
        <p className={styles.screen_logo_top}>Hayat construction group</p>
        <div className={styles.screen_logoMain}>
          <svg width="912" height="128" viewBox="0 0 320 45" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clipPath="url(#clip0_108_13210)">
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M253.908 38.1956C256.751 38.1956 259.345 37.5797 261.728 36.348C264.098 35.1162 266.044 33.4778 267.542 31.421L273.333 35.3486C271.116 38.091 268.333 40.2756 264.983 41.8792C261.633 43.4944 257.942 44.2962 253.908 44.2962C250.582 44.2962 247.457 43.7152 244.532 42.5415C241.607 41.3679 239.059 39.7875 236.877 37.7889C234.707 35.7902 232.985 33.4546 231.723 30.7703C230.461 28.086 229.825 25.2158 229.825 22.1481C229.825 19.0804 230.461 16.2102 231.723 13.5259C232.985 10.8416 234.707 8.50599 236.877 6.50732C239.048 4.50864 241.595 2.9283 244.532 1.75466C247.457 0.581021 250.582 0 253.908 0C257.942 0 261.633 0.801778 264.983 2.41699C268.333 4.03219 271.116 6.20516 273.333 8.94753L267.542 12.8752C266.033 10.8184 264.098 9.17995 261.728 7.94821C259.357 6.71647 256.751 6.1006 253.908 6.1006C251.597 6.1006 249.438 6.51893 247.421 7.3672C245.405 8.21547 243.647 9.36588 242.138 10.8184C240.628 12.2709 239.437 13.9675 238.54 15.8964C237.656 17.837 237.208 19.9054 237.208 22.1249C237.208 24.3443 237.656 26.4243 238.54 28.3533C239.425 30.2938 240.628 31.9788 242.138 33.4313C243.647 34.8838 245.405 36.0342 247.421 36.8825C249.438 37.7656 251.597 38.1956 253.908 38.1956Z"
                fill="#E0D9CC"
              />
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M130.748 19.673C130.795 20.1146 130.83 20.5445 130.842 20.9396C130.865 21.3463 130.877 21.7414 130.877 22.1481C130.877 22.7175 130.854 23.252 130.807 23.7865C130.76 24.3095 130.701 24.8324 130.607 25.3553C130.207 28.0163 129.314 30.503 127.926 32.8271C126.539 35.1511 124.788 37.1498 122.683 38.8463C120.579 40.5429 118.181 41.8676 115.489 42.8437C112.796 43.8081 109.916 44.2962 106.871 44.2962C103.556 44.2962 100.429 43.7152 97.4902 42.5415C94.5512 41.3679 92.0001 39.7875 89.837 37.7889C87.6739 35.7902 85.9576 33.4546 84.6997 30.7703C83.4418 28.086 82.807 25.2158 82.807 22.1481C82.807 19.0804 83.4418 16.2102 84.6997 13.5259C85.9576 10.8416 87.6739 8.50599 89.837 6.50732C92.0001 4.50864 94.5512 2.9283 97.4902 1.75466C100.429 0.581021 103.556 0 106.871 0C109.387 0 111.785 0.336969 114.066 0.99932C116.347 1.66167 118.428 2.60292 120.332 3.81142C122.237 5.01992 123.918 6.46083 125.399 8.13414C126.88 9.80745 128.079 11.6318 129.008 13.6072H120.849C119.392 11.3529 117.44 9.52855 114.983 8.15736C112.526 6.78618 109.822 6.1006 106.86 6.1006C104.567 6.1006 102.392 6.51893 100.359 7.3672C98.3249 8.21547 96.5615 9.36588 95.0567 10.8184C93.5519 12.2709 92.3646 13.9675 91.4711 15.8964C90.5894 17.837 90.1427 19.9054 90.1427 22.1249C90.1427 24.3443 90.5894 26.4243 91.4711 28.3533C92.3528 30.2938 93.5519 31.9788 95.0567 33.4313C96.5615 34.8838 98.3249 36.0342 100.359 36.8825C102.392 37.7308 104.556 38.1491 106.86 38.1491C108.846 38.1491 110.751 37.8237 112.561 37.1846C114.372 36.5339 115.994 35.6391 117.428 34.4887C118.863 33.3383 120.085 31.9788 121.073 30.41C122.072 28.8413 122.766 27.1448 123.165 25.332H119.78L112.173 19.6381H123.295H130.748V19.673Z"
                fill="#E0D9CC"
              />
              <path
                d="M214.812 27.6595V8.15324L222.105 0.0113983V17.9007L214.812 27.6595ZM186.892 16.8417V44.2962H180V0L222.105 44.2962H212.535L186.892 16.8417Z"
                fill="#E0D9CC"
              />
              <path
                d="M17.1482 25.5435C18.6481 25.5435 20.0299 25.2658 21.2817 24.699C22.5336 24.1321 23.6083 23.3917 24.5177 22.4662C25.4271 21.5407 26.1593 20.4764 26.7026 19.2964C27.2458 18.1049 27.5175 16.867 27.5175 15.5829C27.5175 14.3335 27.2458 13.1072 26.7026 11.8925C26.1593 10.6894 25.4271 9.62508 24.5177 8.72273C23.6083 7.82038 22.5336 7.07999 21.2817 6.51313C20.0299 5.94627 18.6599 5.66861 17.1482 5.66861H13.6288H7.38129H6.30657L0.0118036 0H16.2506C18.2938 0 20.2188 0.231379 22.014 0.694123C23.8091 1.15687 25.4625 1.79312 26.9624 2.59136C30.6471 4.639 33.1272 7.50802 34.4027 11.21C34.45 11.4066 34.4972 11.5917 34.5444 11.7537C34.5917 11.9157 34.6625 12.0892 34.7452 12.2974V12.5982C34.8397 12.7949 34.8987 13.0147 34.9106 13.2576C34.9342 13.5005 34.9696 13.7435 35.0168 13.9749C35.0641 14.2757 35.0877 14.5186 35.0877 14.7615V15.5482V15.7333V16.4506C35.0877 16.6935 35.0641 16.9364 35.0168 17.1678V17.2835C34.9696 17.5264 34.9342 17.7578 34.9106 17.9776C34.8869 18.1974 34.8279 18.4288 34.7452 18.6717V18.9147C34.5681 19.3543 34.45 19.736 34.4027 20.0599C33.765 21.8646 32.8202 23.4958 31.5683 24.9419C30.3164 26.388 28.7811 27.6142 26.9624 28.6207C26.8679 28.7017 26.7616 28.7595 26.6199 28.8058C26.4782 28.8405 26.3719 28.9099 26.2774 28.9909L35.0759 44.2962H27.3639L19.652 30.9807C19.1087 31.0617 18.5536 31.1195 18.0104 31.1658C17.4671 31.2005 16.8766 31.2236 16.2388 31.2236H7.29861V34.3125V44.2962H0V25.5666V25.3468L7.29861 17.0753V25.5782H13.6052H17.1482V25.5435Z"
                fill="#E0D9CC"
              />
              <path
                d="M69.7639 24.6012L75.7895 18.3431H50.7512V6.2581H69.7639L75.7895 0H50.7512H43.5088V44.2962H43.5205H69.7639L75.7895 38.0497H50.7512V24.6012H69.7639Z"
                fill="#E0D9CC"
              />
              <path
                d="M165.137 24.6012L171.228 18.3431H145.906V6.2581H165.137L171.228 0H145.906H138.596V44.2962H138.608H165.137L171.228 38.0497H145.906V24.6012H165.137Z"
                fill="#E0D9CC"
              />
              <path
                d="M319.929 0.115602L296.443 44.1921L288.178 44.2962L308.281 6.3115L311.605 0.0462128H320L319.929 0.115602ZM293.012 25.6968L277.544 0.0577836L285.655 0L296.691 19.5009L293.012 25.6968Z"
                fill="#E0D9CC"
              />
            </g>
            <defs>
              <clipPath id="clip0_108_13210">
                <rect width="320" height="44.2962" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </div>
        <p className={styles.screen_subtext}>
          ЖИЛОЙ КОМПЛЕКС ПРЕМИУМ-Класса <br /> расположенный в экологичном и <br /> красивом районе алматы.
        </p>
        <div className={styles.screen_bottom}>
          <div className={styles.screen_bottom_nav}>
            <Button rounded transparent gold_border>
              <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M16.0002 5.33341L16.0002 26.6667M16.0002 26.6667L24.0002 18.6667M16.0002 26.6667L8.00024 18.6667"
                  stroke="#E0D9CC"
                  strokeWidth="1.4"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            </Button>
            <p>
              ЖИЛОЙ КОМПЛЕКС ПРЕМИУМ-Класса <br /> расположенный в экологичном и <br /> красивом районе алматы.
            </p>
          </div>
          <p className={styles.screen_bottom_info}>
            место, где <br />
            ваши мечты <br /> становятся <br /> реальностью
          </p>
        </div>
      </section>
      <div className={styles.bottom_call} ref={ref}>
        <Button gold_100 onClick={() => setIsBackCall(true)}>
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
            <g clipPath="url(#clip0_256_543)">
              <path
                d="M18.3952 13.1277C17.1707 13.1277 15.9684 12.9362 14.8291 12.5597C14.2708 12.3693 13.5845 12.544 13.2438 12.8939L10.995 14.5915C8.38703 13.1994 6.78057 11.5934 5.40745 9.00505L7.0551 6.81484C7.48318 6.38734 7.63672 5.76286 7.45276 5.17693C7.07464 4.03161 6.88255 2.8299 6.88255 1.6049C6.8826 0.719948 6.16266 0 5.27776 0H1.60484C0.719948 0 0 0.719948 0 1.60484C0 11.7481 8.25198 20 18.3952 20C19.2801 20 20.0001 19.2801 20.0001 18.3952V14.7325C20 13.8477 19.2801 13.1277 18.3952 13.1277Z"
                fill="#171516"
              />
            </g>
            <defs>
              <clipPath id="clip0_256_543">
                <rect width="20" height="20" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </Button>
      </div>
      {isSidebarVisible && (
        <Sidebar
          setIsSidebarVisible={setIsSidebarVisible}
          setIsBackCall={setIsBackCall}
          sidebarImage={props.sidebarImage}
        />
      )}
      {isBackCall &&
        createPortal(<BackCallModal closeModal={() => setIsBackCall(false)}></BackCallModal>, document.body)}
    </>
  );
};
